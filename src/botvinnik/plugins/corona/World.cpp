/*
 -------------------------------------------------------------------------------
    This file is part of the botvinnik Matrix bot.
    Copyright (C) 2021, 2022, 2023, 2025  Dirk Stolle

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
 -------------------------------------------------------------------------------
*/

#include "World.hpp"
#include <algorithm>
#include <functional>
#include <unordered_map>
#include "../../../util/Strings.hpp"

namespace bvn
{

std::vector<Country> World::all()
{
  return {
    { 1, "Afghanistan", "AF", 38041757 },
    { 2, "Albania", "AL", 2862427 },
    { 3, "Algeria", "DZ", 43053054 },
    { 4, "American Samoa", "AS", 55197 },
    { 5, "Andorra", "AD", 76177 },
    { 6, "Angola", "AO", 31825299 },
    { 7, "Anguilla", "AI", 14872 },
    { 8, "Antigua and Barbuda", "AG", 97115 },
    { 9, "Argentina", "AR", 44780675 },
    { 10, "Armenia", "AM", 2957728 },
    { 11, "Aruba", "AW", 106310 },
    { 12, "Australia", "AU", 25203200 },
    { 13, "Austria", "AT", 8858775 },
    { 14, "Azerbaijan", "AZ", 10047719 },
    { 15, "Bahamas", "BS", 389486 },
    { 16, "Bahrain", "BH", 1641164 },
    { 17, "Bangladesh", "BD", 163046173 },
    { 18, "Barbados", "BB", 287021 },
    { 19, "Belarus", "BY", 9452409 },
    { 20, "Belgium", "BE", 11455519 },
    { 21, "Belize", "BZ", 390351 },
    { 22, "Benin", "BJ", 11801151 },
    { 23, "Bermuda", "BM", 62508 },
    { 24, "Bhutan", "BT", 763094 },
    { 25, "Bolivia", "BO", 11513102 },
    { 26, "Bonaire", "XA", 19179 },
    { 26, "Bonaire Sint Eustatius and Saba", "BS", 25983 },
    { 27, "Bosnia and Herzegovina", "BA", 3300998 },
    { 28, "Botswana", "BW", 2303703 },
    { 29, "Brazil", "BR", 211049519 },
    { 30, "British Virgin Islands", "VG", 30033 },
    { 31, "Brunei Darussalam", "BN", 433296 },
    { 31, "Brunei", "BN", 433296 },
    { 32, "Bulgaria", "BG", 7000039 },
    { 33, "Burkina Faso", "BF", 20321383 },
    { 34, "Burundi", "BI", 11530577 },
    { 35, "Cabo Verde", "CV", 549936 },
    { 36, "Cambodia", "KH", 16486542 },
    { 37, "Cameroon", "CM", 25876387 },
    { 38, "Canada", "CA", 37411038 },
    { 35, "Cape Verde", "CV", 549936 },
    { 39, "Cayman Islands", "KY", 64948 },
    { 40, "Central African Republic", "CF", 4745179 },
    { 41, "Chad", "TD", 15946882 },
    { 42, "Chile", "CL", 18952035 },
    { 43, "China", "CN", 1433783692 },
    { 44, "Colombia", "CO", 50339443 },
    { 45, "Comoros", "KM", 850891 },
    { 46, "Congo", "CG", 5380504 },
    { 47, "Cook Islands", "CK", 17459 },
    { 48, "Costa Rica", "CR", 5047561 },
    { 49, "Côte d’Ivoire", "CI", 25716554 },
    { 49, "Cote d'Ivoire", "CI", 25716554 },
    { 50, "Croatia", "HR", 4076246 },
    { 51, "Cuba", "CU", 11333484 },
    { 52, "Curacao", "CW", 163423 },
    { 52, "Curaçao", "CW", 163423 },
    { 53, "Cyprus", "CY", 875899 },
    { 54, "Czechia", "CZ", 10649800 },
    { 55, "Democratic People's Republic of Korea", "KP", 25549604 },
    { 56, "Democratic Republic of Congo", "CD", 86790568 },
    { 56, "Democratic Republic of the Congo", "CD", 86790568 },
    { 57, "Denmark", "DK", 5806081 },
    { 58, "Djibouti", "DJ", 973557 },
    { 59, "Dominica", "DM", 71808 },
    { 60, "Dominican Republic", "DO", 10738957 },
    { 213, "East Timor", "TL", 1293120 },
    { 61, "Ecuador", "EC", 17373657 },
    { 62, "Egypt", "EG", 100388076 },
    { 63, "El Salvador", "SV", 6453550 },
    { 64, "Equatorial Guinea", "GQ", 1355982 },
    { 65, "Eritrea", "ER", 3497117 },
    { 66, "Estonia", "EE", 1324820 },
    { 67, "Eswatini", "SZ", 1148133 },
    { 68, "Ethiopia", "ET", 112078727 },
    { 69, "Falkland Islands", "FK", 3372 },
    { 69, "Falkland Islands (Malvinas)", "FK", 3372 },
    { 70, "Faroe Islands", "FO", 48677 },
    { 71, "Fiji", "FJ", 889955 },
    { 72, "Finland", "FI", 5517919 },
    { 73, "France", "FR", 67012883 },
    { 74, "French Guiana", "GF", 304557 },
    { 75, "French Polynesia", "PF", 279285 },
    { 76, "Gabon", "GA", 2172578 },
    { 77, "Gambia", "GM", 2347696 },
    { 78, "Georgia", "GE", 3996762 },
    { 79, "Germany", "DE", 83019213 },
    { 80, "Ghana", "GH", 30417858 },
    { 81, "Gibraltar", "GI", 33706 },
    { 82, "Greece", "GR", 10724599 },
    { 82, "Greece", "EL", 10724599 },
    { 83, "Greenland", "GL", 56660 },
    { 84, "Grenada", "GD", 112002 },
    { 85, "Guadeloupe", "GP", 395752 },
    { 86, "Guam", "GU", 167295 },
    { 87, "Guatemala", "GT", 17581476 },
    { 88, "Guernsey", "GG", 64468 },
    { 89, "Guinea", "GN", 12771246 },
    { 90, "Guinea Bissau", "GW", 1920917 },
    { 90, "Guinea-Bissau", "GW", 1920917 },
    { 91, "Guyana", "GY", 782775 },
    { 92, "Haiti", "HT", 11263079 },
    { 93, "Holy See", "VA", 815 },
    { 94, "Honduras", "HN", 9746115 },
    { 95, "Hungary", "HU", 9772756 },
    { 96, "Iceland", "IS", 356991 },
    { 97, "India", "IN", 1366417756 },
    { 98, "Indonesia", "ID", 270625567 },
    { 99, "Iran", "IR", 82913893 },
    { 99, "Iran (Islamic Republic of)", "IR", 82913893 },
    { 99, "Islamic Republic of Iran", "IR", 82913893 },
    { 100, "Iraq", "IQ", 39309789 },
    { 101, "Ireland", "IE", 4904240 },
    { 102, "Isle of Man", "IM", 84589 },
    { 103, "Israel", "IL", 8519373 },
    { 104, "Italy", "IT", 60359546 },
    { 105, "Jamaica", "JM", 2948277 },
    { 106, "Japan", "JP", 126860299 },
    { 107, "Jersey", "JE", 107796 },
    { 108, "Jordan", "JO", 10101697 },
    { 109, "Kazakhstan", "KZ", 18551428 },
    { 110, "Kenya", "KE", 52573967 },
    { 111, "Kiribati", "KI", 119940 },
    { 112, "Kosovo", "XK", 1798506 },
    { 113, "Kuwait", "KW", 4207077 },
    { 114, "Kyrgyzstan", "KG", 6415851 },
    { 115, "Laos", "LA", 7169456 },
    { 115, "Lao People's Democratic Republic", "LA", 7169456 },
    { 116, "Latvia", "LV", 1919968 },
    { 117, "Lebanon", "LB", 6855709 },
    { 118, "Lesotho", "LS", 2125267 },
    { 119, "Liberia", "LR", 4937374 },
    { 120, "Libya", "LY", 6777453 },
    { 121, "Liechtenstein", "LI", 38378 },
    { 122, "Lithuania", "LT", 2794184 },
    { 123, "Luxembourg", "LU", 613894 },
    { 124, "Madagascar", "MG", 26969306 },
    { 125, "Malawi", "MW", 18628749 },
    { 126, "Malaysia", "MY", 31949789 },
    { 127, "Maldives", "MV", 530957 },
    { 128, "Mali", "ML", 19658023 },
    { 129, "Malta", "MT", 493559 },
    { 130, "Marshall Islands", "MH", 58791 },
    { 131, "Martinique", "MQ", 361225 },
    { 132, "Mauritania", "MR", 4525698 },
    { 133, "Mauritius", "MU", 1269670 },
    { 134, "Mayotte", "YT", 256518 },
    { 135, "Mexico", "MX", 127575529 },
    { 136, "Micronesia", "FM", 115021 },
    { 136, "Micronesia (country)", "FM", 115021 },
    { 136, "Micronesia (Federated States of)", "FM", 115021 },
    { 136, "Federated States of Micronesia", "FM", 115021 },
    { 173, "Moldova", "MD", 4043258 },
    { 137, "Monaco", "MC", 33085 },
    { 138, "Mongolia", "MN", 3225166 },
    { 139, "Montenegro", "ME", 622182 },
    { 140, "Montserrat", "MS", 4991 },
    { 141, "Morocco", "MA", 36471766 },
    { 142, "Mozambique", "MZ", 30366043 },
    { 143, "Myanmar", "MM", 54045422 },
    { 144, "Namibia", "NA", 2494524 },
    { 145, "Nauru", "NR", 11550 },
    { 146, "Nepal", "NP", 28608715 },
    { 147, "Netherlands", "NL", 17282163 },
    { 148, "New Caledonia", "NC", 282757 },
    { 149, "New Zealand", "NZ", 4783062 },
    { 150, "Nicaragua", "NI", 6545503 },
    { 151, "Niger", "NE", 23310719 },
    { 152, "Nigeria", "NG", 200963603 },
    { 153, "Niue", "NU", 1784 },
    { 154, "North Macedonia", "MK", 2077132 },
    { 155, "Northern Mariana Islands", "MP", 57213 },
    { 155, "Northern Mariana Islands (Commonwealth of the)", "MP", 57213 },
    { 155, "Commonwealth of the Northern Mariana Islands", "MP", 57213 },
    { 156, "Norway", "NO", 5328212 },
    { 157, "occupied Palestinian territory, including east Jerusalem", "PS", 4981422 },
    { 158, "Oman", "OM", 4974992 },
    { 159, "Other", " ", -1 },
    { 160, "Pakistan", "PK", 216565317 },
    { 161, "Palau", "PW", 18092 },
    { 157, "Palestine", "PS", 4981422 },
    { 162, "Panama", "PA", 4246440 },
    { 163, "Papua New Guinea", "PG", 8776119 },
    { 164, "Paraguay", "PY", 7044639 },
    { 165, "Peru", "PE", 32510462 },
    { 166, "Philippines", "PH", 108116622 },
    { 167, "Pitcairn", "PN", 40 },
    { 167, "Pitcairn Islands", "PN", 40 },
    { 168, "Poland", "PL", 37972812 },
    { 169, "Portugal", "PT", 10276617 },
    { 170, "Puerto Rico", "PR", 2933404 },
    { 171, "Qatar", "QA", 2832071 },
    { 172, "Republic of Korea", "KR", 51225321 },
    { 173, "Republic of Moldova", "MD", 4043258 },
    { 174, "Réunion", "RE", 863083 },
    { 174, "Reunion", "RE", 863083 },
    { 175, "Romania", "RO", 19414458 },
    { 176, "Russia", "RU", 145872260 },
    { 176, "Russian Federation", "RU", 145872260 },
    { 177, "Rwanda", "RW", 12626938 },
    { 178, "Saba", "XC", 1918 },
    { 179, "Saint Barthélemy", "BL", 10457 },
    { 179, "Saint Barthelemy", "BL", 10457 },
    { 180, "Saint Helena, Ascension and Tristan da Cunha", "SH", 5633 },
    { 181, "Saint Kitts and Nevis", "KN", 52834 },
    { 182, "Saint Lucia", "LC", 182795 },
    { 183, "Saint Martin", "MF", 31801 },
    { 183, "Saint Martin (French part)", "MF", 31801 },
    { 184, "Saint Pierre and Miquelon", "PM", 5925 },
    { 185, "Saint Vincent and the Grenadines", "VC", 110593 },
    { 186, "Samoa", "WS", 198410 },
    { 187, "San Marino", "SM", 34453 },
    { 188, "Sao Tome and Principe", "ST", 215048 },
    { 189, "Saudi Arabia", "SA", 34268529 },
    { 190, "Senegal", "SN", 16296362 },
    { 191, "Serbia", "RS", 6963764 },
    { 192, "Seychelles", "SC", 97741 },
    { 193, "Sierra Leone", "SL", 7813207 },
    { 194, "Singapore", "SG", 5804343 },
    { 195, "Sint Eustatius", "XB", 3142 },
    { 196, "Sint Maarten", "SX", 42389 },
    { 196, "Sint Maarten (Dutch part)", "SX", 42389 },
    { 197, "Slovakia", "SK", 5450421 },
    { 198, "Slovenia", "SI", 2080908 },
    { 199, "Solomon Islands", "SB", 669821 },
    { 200, "Somalia", "SO", 15442906 },
    { 201, "South Africa", "ZA", 58558267 },
    { 172, "South Korea", "KR", 51225321 },
    { 202, "South Sudan", "SS", 11062114 },
    { 203, "Spain", "ES", 46937060 },
    { 204, "Sri Lanka", "LK", 21323734 },
    { 205, "Sudan", "SD", 42813237 },
    { 206, "Suriname", "SR", 581363 },
    { 207, "Sweden", "SE", 10230185 },
    { 208, "Switzerland", "CH", 8544527 },
    { 209, "Syria", "SY", 17070132 },
    { 209, "Syrian Arab Republic", "SY", 17070132 },
    // WHO has no data for Taiwan.
    // { 189, "Taiwan", "TW", 23773881 },
    { 210, "Tajikistan", "TJ", 9321023 },
    { 211, "Thailand", "TH", 69625581 },
    { 212, "The United Kingdom", "GB", 66647112 },
    { 213, "Timor Leste", "TL", 1293120 },
    { 214, "Togo", "TG", 8082359 },
    { 215, "Tokelau", "TK", 1499 },
    { 216, "Tonga", "TO", 105697 },
    { 217, "Trinidad and Tobago", "TT", 1394969 },
    { 218, "Tunisia", "TN", 11694721 },
    { 219, "Turkey", "TR", 82003882 },
    { 219, "Türkiye", "TR", 82003882 },
    { 220, "Turkmenistan", "TM", 6430770 },
    { 221, "Turks and Caicos islands", "TC", 38194 },
    { 222, "Tuvalu", "TV", 10507 },
    { 223, "Uganda", "UG", 44269587 },
    { 224, "Ukraine", "UA", 43993643 },
    { 225, "United Arab Emirates", "AE", 9770526 },
    { 212, "United Kingdom", "GB", 66647112 },
    // UK is no official ISO-3166 code for the United Kingdom, but it is
    // sometimes used in other places as code for it, so keep it here to let
    // the people who use the wrong code still find the country.
    { 212, "United Kingdom", "UK", 66647112 },
    { 226, "United Republic of Tanzania", "TZ", 58005461 },
    { 226, "Tanzania", "TZ", 58005461 },
    { 227, "United States", "US", 329064917 },
    { 227, "United States of America", "US", 329064917 },
    { 227, "USA", "US", 329064917 },
    { 228, "United States Virgin Islands", "VI", 104579 },
    { 229, "Uruguay", "UY", 3461731 },
    { 230, "Uzbekistan", "UZ", 32981715 },
    { 231, "Vanuatu", "VU", 299882 },
    { 232, "Venezuela", "VE", 28515829 },
    { 232, "Venezuela (Bolivarian Republic of)", "VE", 28515829 },
    { 232, "Bolivarian Republic of Venezuela", "VE", 28515829 },
    { 233, "Vietnam", "VN", 96462108 },
    { 233, "Viet Nam", "VN", 96462108 },
    { 234, "Wallis and Futuna", "WF", -1 },
    { 211, "Western Sahara", "EH", 582458 },
    { 235, "Yemen", "YE", 29161922 },
    { 236, "Zambia", "ZM", 17861034 },
    { 237, "Zimbabwe", "ZW", 14645473 }
  };
}

std::optional<Country> World::find(const std::string& nameOrGeoId)
{
  const auto lower = toLowerString(nameOrGeoId);
  const auto countries = World::all();
  auto predicate = [&] (const Country& c) {
    return toLowerString(c.geoId) == lower || lower == toLowerString(c.name);
  };
  const auto iter = std::find_if(countries.begin(), countries.end(), predicate);
  if (iter != countries.end())
  {
    return std::optional<Country>(*iter);
  }
  // No match found.
  return std::optional<Country>();
}

} // namespace
