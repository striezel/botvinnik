/*
 -------------------------------------------------------------------------------
    This file is part of the botvinnik Matrix bot.
    Copyright (C) 2021, 2022, 2023, 2025  Dirk Stolle

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
 -------------------------------------------------------------------------------
*/

#include "World.hpp"
#include <algorithm>
#include <functional>
#include <unordered_map>
#include "../../../util/Strings.hpp"

namespace bvn
{

std::vector<Country> World::all()
{
  return {
    { 1, "Afghanistan", "AFG", 38041757 },
    { 2, "Albania", "ALB", 2862427 },
    { 3, "Algeria", "DZA", 43053054 },
    { 4, "American Samoa", "ASM", 55197 },
    { 5, "Andorra", "AND", 76177 },
    { 6, "Angola", "AGO", 31825299 },
    { 7, "Anguilla", "AIA", 14872 },
    { 8, "Antigua and Barbuda", "ATG", 97115 },
    { 9, "Argentina", "ARG", 44780675 },
    { 10, "Armenia", "ARM", 2957728 },
    { 11, "Aruba", "ABW", 106310 },
    { 12, "Australia", "AUS", 25203200 },
    { 13, "Austria", "AUT", 8858775 },
    { 14, "Azerbaijan", "AZE", 10047719 },
    { 15, "Bahamas", "BHS", 389486 },
    { 16, "Bahrain", "BHR", 1641164 },
    { 17, "Bangladesh", "BGD", 163046173 },
    { 18, "Barbados", "BRB", 287021 },
    { 19, "Belarus", "BLR", 9452409 },
    { 20, "Belgium", "BEL", 11455519 },
    { 21, "Belize", "BLZ", 390351 },
    { 22, "Benin", "BEN", 11801151 },
    { 23, "Bermuda", "BMU", 62508 },
    { 24, "Bhutan", "BTN", 763094 },
    { 25, "Bolivia", "BOL", 11513102 },
    { 26, "Bonaire", "XA", 19179 },
    { 26, "Bonaire Sint Eustatius and Saba", "BES", 25983 },
    { 27, "Bosnia and Herzegovina", "BIH", 3300998 },
    { 28, "Botswana", "BWA", 2303703 },
    { 29, "Brazil", "BRA", 211049519 },
    { 30, "British Virgin Islands", "VGB", 30033 },
    { 31, "Brunei", "BRN", 433296 },
    { 31, "Brunei Darussalam", "BRN", 433296 },
    { 32, "Bulgaria", "BGR", 7000039 },
    { 33, "Burkina Faso", "BFA", 20321383 },
    { 34, "Burundi", "BDI", 11530577 },
    { 38, "Cabo Verde", "CPV", 549936 },
    { 35, "Cambodia", "KHM", 16486542 },
    { 36, "Cameroon", "CMR", 25876387 },
    { 37, "Canada", "CAN", 37411038 },
    { 38, "Cape Verde", "CPV", 549936 },
    { 39, "Cayman Islands", "CYM", 64948 },
    { 40, "Central African Republic", "CAF", 4745179 },
    { 41, "Chad", "TCD", 15946882 },
    { 42, "Chile", "CHL", 18952035 },
    { 43, "China", "CHN", 1433783692 },
    { 44, "Colombia", "COL", 50339443 },
    { 45, "Comoros", "COM", 850891 },
    { 46, "Congo", "COG", 5380504 },
    { 47, "Cook Islands", "COK", 17459 },
    { 48, "Costa Rica", "CRI", 5047561 },
    { 49, "Côte d’Ivoire", "CIV", 25716554 },
    { 49, "Cote d'Ivoire", "CIV", 25716554 },
    { 50, "Croatia", "HRV", 4076246 },
    { 51, "Cuba", "CUB", 11333484 },
    { 52, "Curacao", "CUW", 163423 },
    { 52, "Curaçao", "CUW", 163423 },
    { 53, "Cyprus", "CYP", 875899 },
    { 54, "Czechia", "CZE", 10649800 },
    { 156, "Democratic People's Republic of Korea", "PRK", 25549604 },
    { 55, "Democratic Republic of Congo", "COD", 86790568 },
    { 55, "Democratic Republic of the Congo", "COD", 86790568 },
    { 56, "Denmark", "DNK", 5806081 },
    { 57, "Djibouti", "DJI", 973557 },
    { 58, "Dominica", "DMA", 71808 },
    { 59, "Dominican Republic", "DOM", 10738957 },
    { 60, "East Timor", "TLS", 1293120 },
    { 61, "Ecuador", "ECU", 17373657 },
    { 62, "Egypt", "EGY", 100388076 },
    { 63, "El Salvador", "SLV", 6453550 },
    { 64, "Equatorial Guinea", "GNQ", 1355982 },
    { 65, "Eritrea", "ERI", 3497117 },
    { 66, "Estonia", "EST", 1324820 },
    { 67, "Eswatini", "SWZ", 1148133 },
    { 68, "Ethiopia", "ETH", 112078727 },
    { 69, "Falkland Islands", "FLK", 3372 },
    { 69, "Falkland Islands (Malvinas)", "FLK", 3372 },
    { 70, "Faroe Islands", "FRO", 48677 },
    { 71, "Fiji", "FJI", 889955 },
    { 72, "Finland", "FIN", 5517919 },
    { 73, "France", "FRA", 67012883 },
    { 74, "French Guiana", "GUF", 304557 },
    { 75, "French Polynesia", "PYF", 279285 },
    { 76, "Gabon", "GAB", 2172578 },
    { 77, "Gambia", "GMB", 2347696 },
    { 78, "Georgia", "GEO", 3996762 },
    { 79, "Germany", "DEU", 83019213 },
    { 80, "Ghana", "GHA", 30417858 },
    { 81, "Gibraltar", "GIB", 33706 },
    { 82, "Greece", "GRC", 10724599 },
    // "GRE" is not the official code for Greece, but it's used in some places.
    { 82, "Greece", "GRE", 10724599 },
    { 83, "Greenland", "GRL", 56660 },
    { 84, "Grenada", "GRD", 112002 },
    { 85, "Guadeloupe", "GLP", 395752 },
    { 86, "Guam", "GUM", 167295 },
    { 87, "Guatemala", "GTM", 17581476 },
    { 88, "Guernsey", "GGY", 64468 },
    { 89, "Guinea", "GIN", 12771246 },
    { 90, "Guinea Bissau", "GNB", 1920917 },
    { 90, "Guinea-Bissau", "GNB", 1920917 },
    { 91, "Guyana", "GUY", 782775 },
    { 92, "Haiti", "HTI", 11263079 },
    { 230, "Holy See", "VAT", 815 },
    { 93, "Honduras", "HND", 9746115 },
    // { 94, "Hong Kong", "HKG", -1 },
    { 95, "Hungary", "HUN", 9772756 },
    { 96, "Iceland", "ISL", 356991 },
    { 97, "India", "IND", 1366417756 },
    { 98, "Indonesia", "IDN", 270625567 },
    { 99, "Iran", "IRN", 82913893 },
    { 99, "Islamic Republic of Iran", "IRN", 82913893 },
    { 100, "Iraq", "IRQ", 39309789 },
    { 101, "Ireland", "IRL", 4904240 },
    { 102, "Isle of Man", "IMN", 84589 },
    { 103, "Israel", "ISR", 8519373 },
    { 104, "Italy", "ITA", 60359546 },
    { 105, "Jamaica", "JAM", 2948277 },
    { 106, "Japan", "JPN", 126860299 },
    { 107, "Jersey", "JEY", 107796 },
    { 108, "Jordan", "JOR", 10101697 },
    { 109, "Kazakhstan", "KAZ", 18551428 },
    { 110, "Kenya", "KEN", 52573967 },
    { 111, "Kiribati", "KIR", 119940 },
    { 112, "Kosovo", "KOS", 1798506 },
    { 113, "Kuwait", "KWT", 4207077 },
    { 114, "Kyrgyzstan", "KGZ", 6415851 },
    { 115, "Laos", "LAO", 7169456 },
    { 115, "Lao People's Democratic Republic", "LAO", 7169456 },
    { 116, "Latvia", "LVA", 1919968 },
    { 117, "Lebanon", "LBN", 6855709 },
    { 118, "Lesotho", "LSO", 2125267 },
    { 119, "Liberia", "LBR", 4937374 },
    { 120, "Libya", "LBY", 6777453 },
    { 121, "Liechtenstein", "LIE", 38378 },
    { 122, "Lithuania", "LTU", 2794184 },
    { 123, "Luxembourg", "LUX", 613894 },
    // { 124, "Macao", "MAC", -1 },
    { 125, "Madagascar", "MDG", 26969306 },
    { 126, "Malawi", "MWI", 18628749 },
    { 127, "Malaysia", "MYS", 31949789 },
    { 128, "Maldives", "MDV", 530957 },
    { 129, "Mali", "MLI", 19658023 },
    { 130, "Malta", "MLT", 493559 },
    { 131, "Marshall Islands", "MHL", 58791 },
    { 132, "Martinique", "MTQ", 361225 },
    { 133, "Mauritania", "MRT", 4525698 },
    { 134, "Mauritius", "MUS", 1269670 },
    { 135, "Mayotte", "MYT", 256518 },
    { 136, "Mexico", "MEX", 127575529 },
    { 137, "Micronesia", "FSM", 115021 },
    { 137, "Micronesia (country)", "FSM", 115021 },
    { 137, "Federated States of Micronesia", "FSM", 115021 },
    { 138, "Moldova", "MDA", 4043258 },
    { 139, "Monaco", "MCO", 33085 },
    { 140, "Mongolia", "MNG", 3225166 },
    { 141, "Montenegro", "MNE", 622182 },
    { 142, "Montserrat", "MSR", 4991 },
    { 143, "Morocco", "MAR", 36471766 },
    { 144, "Mozambique", "MOZ", 30366043 },
    { 145, "Myanmar", "MMR", 54045422 },
    { 146, "Namibia", "NAM", 2494524 },
    { 147, "Nauru", "NRU", 11550 },
    { 148, "Nepal", "NPL", 28608715 },
    { 149, "Netherlands", "NLD", 17282163 },
    { 150, "New Caledonia", "NCL", 282757 },
    { 151, "New Zealand", "NZL", 4783062 },
    { 152, "Nicaragua", "NIC", 6545503 },
    { 153, "Niger", "NER", 23310719 },
    { 154, "Nigeria", "NGA", 200963603 },
    { 155, "Niue", "NIU", 1784 },
    { 156, "North Korea", "PRK", 25549604 },
    { 157, "North Macedonia", "MKD", 2077132 },
    { 158, "Northern Mariana Islands", "MNP", 57213 },
    { 158, "Commonwealth of the Northern Mariana Islands", "MNP", 57213 },
    { 159, "Norway", "NOR", 5328212 },
    { 160, "Oman", "OMN", 4974992 },
    { 161, "Pakistan", "PAK", 216565317 },
    { 162, "Palau", "PLW", 18092 },
    { 163, "Palestine", "PSE", 4981422 },
    { 164, "Panama", "PAN", 4246440 },
    { 165, "Papua New Guinea", "PNG", 8776119 },
    { 166, "Paraguay", "PRY", 7044639 },
    { 167, "Peru", "PER", 32510462 },
    { 168, "Philippines", "PHL", 108116622 },
    { 169, "Pitcairn", "PCN", 40 },
    { 169, "Pitcairn Islands", "PCN", 40 },
    { 170, "Poland", "POL", 37972812 },
    { 171, "Portugal", "PRT", 10276617 },
    { 172, "Puerto Rico", "PRI", 2933404 },
    { 173, "Qatar", "QAT", 2832071 },
    { 200, "Republic of Korea", "KOR", 51225321 },
    { 138, "Republic of Moldova", "MDA", 4043258 },
    { 174, "Réunion", "REU", 863083 },
    { 174, "Reunion", "REU", 863083 },
    { 175, "Romania", "ROU", 19414458 },
    { 176, "Russia", "RUS", 145872260 },
    { 176, "Russian Federation", "RUS", 145872260 },
    { 177, "Rwanda", "RWA", 12626938 },
    { 26, "Saba", "XC", 1918 },
    { 178, "Saint Barthélemy", "BLM", 10457 },
    { 178, "Saint Barthelemy", "BLM", 10457 },
    { 179, "Saint Helena", "SHN", 5633 },
    { 179, "Saint Helena, Ascension and Tristan da Cunha", "SHN", 5633 },
    { 180, "Saint Kitts and Nevis", "KNA", 52834 },
    { 181, "Saint Lucia", "LCA", 182795 },
    { 182, "Saint Martin", "MAF", 31801 },
    { 182, "Saint Martin (French part)", "MAF", 31801 },
    { 183, "Saint Pierre and Miquelon", "SPM", 5925 },
    { 184, "Saint Vincent and the Grenadines", "VCT", 110593 },
    { 185, "Samoa", "WSM", 198410 },
    { 186, "San Marino", "SMR", 34453 },
    { 187, "Sao Tome and Principe", "STP", 215048 },
    { 188, "Saudi Arabia", "SAU", 34268529 },
    { 189, "Senegal", "SEN", 16296362 },
    { 190, "Serbia", "SRB", 6963764 },
    { 191, "Seychelles", "SYC", 97741 },
    { 192, "Sierra Leone", "SLE", 7813207 },
    { 193, "Singapore", "SGP", 5804343 },
    { 26, "Sint Eustatius", "XB", 3142 },
    { 194, "Sint Maarten", "SXM", 42389 },
    { 194, "Sint Maarten (Dutch part)", "SXM", 42389 },
    { 195, "Slovakia", "SVK", 5450421 },
    { 196, "Slovenia", "SVN", 2080908 },
    { 197, "Solomon Islands", "SLB", 669821 },
    { 198, "Somalia", "SOM", 15442906 },
    { 199, "South Africa", "ZAF", 58558267 },
    { 200, "South Korea", "KOR", 51225321 },
    { 201, "South Sudan", "SSD", 11062114 },
    { 202, "Spain", "ESP", 46937060 },
    { 203, "Sri Lanka", "LKA", 21323734 },
    { 204, "Sudan", "SDN", 42813237 },
    { 205, "Suriname", "SUR", 581363 },
    { 206, "Sweden", "SWE", 10230185 },
    { 207, "Switzerland", "CHE", 8544527 },
    { 208, "Syria", "SYR", 17070132 },
    { 208, "Syrian Arab Republic", "SYR", 17070132 },
    // { 209, "Taiwan", "TWN", -1 },
    { 210, "Tajikistan", "TJK", 9321023 },
    { 211, "Tanzania", "TZA", 58005461 },
    { 212, "Thailand", "THA", 69625581 },
    { 225, "The United Kingdom", "GBR", 66647112 },
    { 60, "Timor Leste", "TLS", 1293120 },
    { 213, "Togo", "TGO", 8082359 },
    { 214, "Tokelau", "TKL", 1499 },
    { 215, "Tonga", "TON", 105697 },
    { 216, "Trinidad and Tobago", "TTO", 1394969 },
    { 217, "Tunisia", "TUN", 11694721 },
    { 218, "Turkey", "TUR", 82003882 },
    { 218, "Türkiye", "TUR", 82003882 },
    { 219, "Turkmenistan", "TKM", 6430770 },
    { 220, "Turks and Caicos Islands", "TCA", 38194 },
    { 221, "Tuvalu", "TUV", 10507 },
    { 222, "Uganda", "UGA", 44269587 },
    { 223, "Ukraine", "UKR", 43993643 },
    { 224, "United Arab Emirates", "ARE", 9770526 },
    { 225, "United Kingdom", "GBR", 66647112 },
    { 211, "United Republic of Tanzania", "TZA", 58005461 },
    { 226, "United States", "USA", 329064917 },
    { 226, "United States of America", "USA", 329064917 },
    { 227, "United States Virgin Islands", "VIR", 104579 },
    { 228, "Uruguay", "URY", 3461731 },
    { 229, "Uzbekistan", "UZB", 32981715 },
    { 230, "Vanuatu", "VUT", 299882 },
    { 231, "Vatican", "VAT", 815 },
    { 232, "Venezuela", "VEN", 28515829 },
    { 232, "Bolivarian Republic of Venezuela", "VEN", 28515829 },
    { 233, "Vietnam", "VNM", 96462108 },
    { 233, "Viet Nam", "VNM", 96462108 },
    { 234, "Wallis and Futuna", "WLF", -1 },
    { 235, "Western Sahara", "ESH", 582458 },
    { 236, "Yemen", "YEM", 29161922 },
    { 237, "Zambia", "ZMB", 17861034 },
    { 238, "Zimbabwe", "ZWE", 14645473 }
  };
}

std::optional<Country> World::find(const std::string& nameOrGeoId)
{
  const auto lower = toLowerString(nameOrGeoId);
  const auto countries = World::all();
  auto predicate = [&] (const Country& c) {
    return toLowerString(c.geoId) == lower || lower == toLowerString(c.name);
  };
  const auto iter = std::find_if(countries.begin(), countries.end(), predicate);
  if (iter != countries.end())
  {
    return std::optional<Country>(*iter);
  }
  // No match found.
  return std::optional<Country>();
}

} // namespace
